def count_visited_fields(directory):
    result = {}
    
    for filename in os.listdir(directory):
        if filename.endswith('.xlsx'):
            file_path = os.path.join(directory, filename)
            
            try:
                df = pd.read_excel(file_path)
                count = df['new_id'].count()
                result[filename] = count
            except Exception as e:
                result[filename] = str(e)
    
    return result
